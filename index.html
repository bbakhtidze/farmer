<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      /* თქვენი CSS სტილები აქ */
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f4f4f4;
      }
      h1 {
        color: #333;
      }
      form {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        max-width: 500px;
        margin: 0 auto;
      }
      label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
      }
      input[type="text"],
      input[type="number"],
      input[type="tel"],
      input[type="email"],
      textarea,
      select {
        width: calc(100% - 22px); /* Padding and border */
        padding: 10px;
        margin-bottom: 15px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box; /* Include padding in width */
      }
      input[type="submit"] {
        background-color: #4CAF50;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      input[type="submit"]:hover {
        background-color: #45a049;
      }
      #response {
        margin-top: 20px;
        padding: 10px;
        border-radius: 4px;
        background-color: #e0ffe0;
        border: 1px solid #aaddaa;
        color: #333;
        display: none; /* Hide by default */
      }
    </style>
  </head>
  <body>
    <h1>შეკვეთების რეგისტრაციის ფორმა</h1>

    <form id="orderForm">
      <label for="orderDate">თარიღი:</label><br>
      <input type="date" id="orderDate" name="orderDate" required><br>

      <label for="customerName">სახელი გვარი:</label><br>
      <input type="text" id="customerName" name="customerName" required><br>

      <label for="customerPhone">ტელეფონი:</label><br>
      <input type="tel" id="customerPhone" name="customerPhone"><br>

      <label for="quantityE">რაოდენობა (E სვეტი):</label><br>
      <input type="number" id="quantityE" name="quantityE" value="0"><br>

      <label for="quantityG">რაოდენობა (G სვეტი):</label><br>
      <input type="number" id="quantityG" name="quantityG" value="0"><br>

      <label for="notes">შენიშვნები (K სვეტი):</label><br>
      <textarea id="notes" name="notes" rows="4"></textarea><br>

      <input type="submit" value="შეკვეთის გაგზავნა">
    </form>

    <div id="response"></div>

    <script>
      document.getElementById('orderForm').addEventListener('submit', function(e) {
        e.preventDefault(); // შეაჩერეთ ფორმის ნაგულისხმევი გაგზავნა

        var form = e.target;
        var formData = {
          orderDate: form.orderDate.value,
          customerName: form.customerName.value,
          customerPhone: form.customerPhone.value,
          quantityE: form.quantityE.value,
          quantityG: form.quantityG.value,
          notes: form.notes.value
        };

        // აჩვენეთ "გზავნის..." შეტყობინება
        var responseDiv = document.getElementById('response');
        responseDiv.style.display = 'block';
        responseDiv.style.backgroundColor = '#ffffcc'; // ყვითელი ფონი
        responseDiv.style.borderColor = '#dddd77';
        responseDiv.textContent = 'შეკვეთა იგზავნება...';

        // გამოიძახეთ Apps Script ფუნქცია
        google.script.run
          .withSuccessHandler(function(res) {
            responseDiv.style.backgroundColor = '#e0ffe0'; // მწვანე ფონი
            responseDiv.style.borderColor = '#aaddaa';
            responseDiv.textContent = res; // აჩვენეთ სერვერიდან მიღებული შეტყობინება
            form.reset(); // გაასუფთავეთ ფორმა წარმატების შემდეგ
          })
          .withFailureHandler(function(error) {
            responseDiv.style.backgroundColor = '#ffe0e0'; // წითელი ფონი
            responseDiv.style.borderColor = '#ddaaaa';
            responseDiv.textContent = 'შეცდომა: ' + error.message; // აჩვენეთ შეცდომის შეტყობინება
            console.error("Error submitting form:", error);
          })
          .processForm(formData); // ეს ფუნქცია უნდა შექმნათ Code.gs-ში
      });
    </script>
  </body>
</html>
